# Blog Backend (TypeScript)

پروژه پایه Node.js برای بک‌اند وبلاگ با استفاده از Express.js و TypeScript

## 📋 فهرست مطالب
- [توضیحات پروژه](#توضیحات-پروژه)
- [ویژگی‌ها](#ویژگیها)
- [شروع سریع](#شروع-سریع)
- [متغیرهای محیطی](#متغیرهای-محیطی)
- [ساختار پروژه](#ساختار-پروژه)
- [مسیرهای API](#مسیرهای-api)
  - [احراز هویت](#احراز-هویت)
  - [کاربران](#کاربران)
  - [پست‌ها](#پستها)
  - [نظرات](#نظرات)
  - [دسته‌بندی‌ها](#دستهبندیها)
  - [برچسب‌ها](#برچسبها)
  - [آنالیز](#آنالیز)
  - [پنل ادمین](#پنل-ادمین)
- [نمونه استفاده](#نمونه-استفاده)
- [کدهای وضعیت HTTP](#کدهای-وضعیت-http)
- [مجوز](#مجوز)

## توضیحات پروژه

این پروژه یک بک‌اند ساده و قدرتمند برای وبلاگ است که با استفاده از Node.js، Express.js و TypeScript توسعه یافته است. این پروژه شامل امکاناتی مانند مدیریت کاربران، احراز هویت، مدیریت پست‌ها، دسته‌بندی‌ها، برچسب‌ها، نظرات، و آنالیز بازدیدها می‌باشد. همچنین از MongoDB به عنوان دیتابیس استفاده می‌کند و قابلیت ارسال ایمیل و آپلود فایل‌ها را دارد.

## ویژگی‌ها

- ✅ احراز هویت با JWT
- ✅ مدیریت کاربران و پروفایل‌ها
- ✅ مدیریت پست‌ها، دسته‌بندی‌ها و برچسب‌ها
- ✅ مدیریت نظرات کاربران
- ✅ آنالیز بازدید صفحات
- ✅ اتصال به MongoDB
- ✅ ارسال ایمیل با SMTP
- ✅ آپلود فایل‌ها به فضای ابری
- ✅ استفاده از TypeScript برای کدنویسی امن

## شروع سریع

1. نصب وابستگی‌ها:
   ```bash
   npm install
   ```
2. اجرای پروژه در حالت توسعه:
   ```bash
   npm run dev
   ```
3. بیلد و اجرای پروژه:
   ```bash
   npm run build
   npm start
   ```

## متغیرهای محیطی

برای اجرای پروژه، یک فایل `.env` در ریشه پروژه بسازید:

| متغیر | توضیح | نمونه |
|-------|--------|--------|
| `PORT` | پورت سرور | `3000` |
| `MONGODB_URI` | آدرس MongoDB | `mongodb://localhost:27017/blog` |
| `JWT_SECRET` | کلید JWT | `your-secret-key` |
| `SMTP_HOST` | سرور SMTP | `smtp.gmail.com` |
| `SMTP_PORT` | پورت SMTP | `587` |
| `SMTP_USER` | ایمیل SMTP | `your-email@gmail.com` |
| `SMTP_PASS` | رمز SMTP | `your-password` |
| `CLOUD_ACCESS_KEY` | کلید دسترسی ابری | `your-access-key` |
| `CLOUD_SECRET_KEY` | کلید مخفی ابری | `your-secret-key` |
| `CLOUD_ENDPOINT` | آدرس endpoint | `s3.amazonaws.com` |
| `CLOUD_REGION` | منطقه | `us-east-1` |
| `CLOUD_BUCKET_NAME` | نام باکت | `your-bucket-name` |

## ساختار پروژه

```
src/
├── app.ts              # نقطه شروع برنامه
├── routes/             # مسیرهای API
├── controllers/        # منطق کسب‌وکار
├── models/             # مدل‌های داده
├── middleware/         # میدلورها
├── utils/              # توابع کمکی
├── validators/         # اعتبارسنجی داده‌ها
└── types/              # تعاریف TypeScript
```

## مسیرهای API

### احراز هویت
| متد | مسیر | توضیح | نیاز به احراز هویت |
|-----|------|--------|-------------------|
| `POST` | `/api/auth/register` | ثبت‌نام کاربر جدید | ❌ |
| `POST` | `/api/auth/login` | ورود کاربر | ❌ |
| `POST` | `/api/auth/logout` | خروج کاربر | ✅ |
| `POST` | `/api/auth/verify-email` | تایید ایمیل | ❌ |

### کاربران
| متد | مسیر | توضیح | نیاز به احراز هویت |
|-----|------|--------|-------------------|
| `GET` | `/api/users/profile` | دریافت پروفایل کاربر | ✅ |
| `PUT` | `/api/users/profile` | ویرایش پروفایل | ✅ |
| `PUT` | `/api/users/avatar` | آپلود آواتار | ✅ |

### پست‌ها
| متد | مسیر | توضیح | نیاز به احراز هویت |
|-----|------|--------|-------------------|
| `GET` | `/api/posts` | دریافت همه پست‌ها | ❌ |
| `GET` | `/api/posts/:id` | دریافت یک پست خاص | ❌ |
| `POST` | `/api/posts` | ایجاد پست جدید | ✅ (ادمین) |
| `PUT` | `/api/posts/:id` | ویرایش پست | ✅ (ادمین) |
| `DELETE` | `/api/posts/:id` | حذف پست | ✅ (ادمین) |

### نظرات
| متد | مسیر | توضیح | نیاز به احراز هویت |
|-----|------|--------|-------------------|
| `GET` | `/api/comments/:id` | دریافت نظرات یک پست | ❌ |
| `POST` | `/api/comments/:id` | افزودن نظر به پست | ✅ |
| `DELETE` | `/api/comments/:id` | حذف نظر | ✅ |
| `PUT` | `/api/comments/accept/:id` | تایید نظر | ✅ (ادمین) |

### دسته‌بندی‌ها
| متد | مسیر | توضیح | نیاز به احراز هویت |
|-----|------|--------|-------------------|
| `GET` | `/api/categories` | دریافت همه دسته‌بندی‌ها | ❌ |
| `GET` | `/api/categories/:id` | دریافت یک دسته‌بندی | ❌ |
| `POST` | `/api/categories` | ایجاد دسته‌بندی جدید | ✅ (ادمین) |
| `PUT` | `/api/categories/:id` | ویرایش دسته‌بندی | ✅ (ادمین) |
| `DELETE` | `/api/categories/:id` | حذف دسته‌بندی | ✅ (ادمین) |
| `GET` | `/api/categories/categories-posts` | پست‌های هر دسته‌بندی | ❌ |

### برچسب‌ها
| متد | مسیر | توضیح | نیاز به احراز هویت |
|-----|------|--------|-------------------|
| `GET` | `/api/tags` | دریافت همه برچسب‌ها | ❌ |
| `GET` | `/api/tags/:id` | دریافت یک برچسب | ❌ |
| `POST` | `/api/tags` | ایجاد برچسب جدید | ✅ (ادمین) |
| `PUT` | `/api/tags/:id` | ویرایش برچسب | ✅ (ادمین) |
| `DELETE` | `/api/tags/:id` | حذف برچسب | ✅ (ادمین) |

### آنالیز
| متد | مسیر | توضیح | نیاز به احراز هویت |
|-----|------|--------|-------------------|
| `POST` | `/api/analytics/page-view` | ثبت بازدید صفحه | ❌ |
| `GET` | `/api/analytics/page-view` | آمار بازدیدها | ✅ (ادمین) |

### پنل ادمین
| متد | مسیر | توضیح | نیاز به احراز هویت |
|-----|------|--------|-------------------|
| `GET` | `/api/admin/users` | لیست همه کاربران | ✅ (ادمین) |
| `GET` | `/api/admin/posts` | لیست پست‌ها با جستجو | ✅ (ادمین) |
| `GET` | `/api/admin/comments` | لیست همه نظرات | ✅ (ادمین) |
| `GET` | `/api/admin/dashboard` | اطلاعات آماری | ✅ (ادمین) |

## نمونه استفاده

### ثبت‌نام کاربر جدید
```bash
curl -X POST http://localhost:3000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "password123",
    "firstName": "John",
    "lastName": "Doe"
  }'
```

### دریافت همه پست‌ها
```bash
curl http://localhost:3000/api/posts
```

### ایجاد پست جدید (نیاز به توکن)
```bash
curl -X POST http://localhost:3000/api/posts \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "عنوان پست",
    "content": "محتوای پست",
    "category": "category-id",
    "tags": ["tag1", "tag2"]
  }'
```

### افزودن نظر
```bash
curl -X POST http://localhost:3000/api/comments/POST_ID \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "content": "نظر من"
  }'
```

## کدهای وضعیت HTTP

| کد | توضیح |
|----|--------|
| `200` | موفقیت آمیز |
| `201` | ایجاد شد |
| `400` | درخواست نامعتبر |
| `401` | احراز هویت ناموفق |
| `403` | دسترسی غیرمجاز |
| `404` | منبع یافت نشد |
| `500` | خطای سرور |

## مجوز

این پروژه تحت مجوز ISC منتشر شده است.

## نویسنده

Mani Alipour

---

## 🚀 راهنمای سریع توسعه

### نصب و راه‌اندازی
1. کلون کردن پروژه:
   ```bash
   git clone [repository-url]
   cd blog-backend
   ```

2. نصب وابستگی‌ها:
   ```bash
   npm install
   ```

3. ایجاد فایل `.env`:
   ```bash
   cp .env.example .env
   ```

4. تنظیم متغیرهای محیطی در `.env`

5. اجرای پروژه:
   ```bash
   npm run dev
   ```

### تست API
برای تست API می‌توانید از ابزارهایی مانند:
- Postman
- Thunder Client (VS Code Extension)
- curl
- HTTPie

### داکیومنت تکمیلی
برای اطلاعات بیشتر در مورد هر endpoint، به فایل‌های مربوطه در `src/controllers/` مراجعه کنید.
